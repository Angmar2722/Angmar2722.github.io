---
layout: page
title: Zh3r0 2021 CTF Writeup
---

<p><img src="/assets/img/ctfImages/zh3r02021/starter.png" alt="Zh3r0 2021 Writeup"></p>
<p>We competed in the <a href="https://ctftime.org/event/1285" target="_blank"> 2021 Zh3r0 CTF V2 CTF</a> event (Fri, 04 June 2021, 18:30 SGT â€” Sun, 06 June 2021, 18:30 SGT). We ranked 48th out of 509 scoring teams.</p>
<p>I managed to solve only 2 challenges (I need to learn so much more....) and both were under the cryptography category (first time solving a cryptography CTF challenge). </p>
<p><img src="/assets/img/ctfImages/zh3r02021/img1.png" alt="Zh3r0 2021 Writeup"></p>
<p>Here are the writeups :</p>
<p><br/></p>
<h1 id="1n_jection-cryptography-">1n_jection (Cryptography)</h1>
<p><img src="/assets/img/ctfImages/zh3r02021/img2.png" alt="Zh3r0 2021 Writeup"></p>
<p>This was the source code provided for the challenge :</p>
<pre><code class="lang-python">
<span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">nk2n</span><span class="hljs-params">(nk)</span>:</span>
    l = len(nk)
    <span class="hljs-keyword">if</span> l==<span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> nk[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">elif</span> l==<span class="hljs-number">2</span>:
        i,j = nk
        <span class="hljs-keyword">return</span> ((i+j)*(i+j+<span class="hljs-number">1</span>))//<span class="hljs-number">2</span> +j
    <span class="hljs-keyword">return</span> nk2n([nk2n(nk[:l-l//<span class="hljs-number">2</span>]), nk2n(nk[l-l//<span class="hljs-number">2</span>:])])

print(nk2n(flag))
<span class="hljs-comment">#2597749519984520018193538914972744028780767067373210633843441892910830749749277631182596420937027368405416666234869030284255514216592219508067528406889067888675964979055810441575553504341722797908073355991646423732420612775191216409926513346494355434293682149298585</span>
</code></pre>
<p>So the encryption function was provided <code>nk2n()</code> and the flag ciphertext was also provided (the commented large integer). So we had to reverse this encryption process from the ciphertext to the flag itself.</p>
<p>The function encrypts text by taking in a <strong>list</strong> of ASCII characters. It then checks if the length of that list is 1 or 2. If it is 1, it returns the element itself (as list length is 1) and if it is 2, it would return ((i+j)<em>(i+j+1))//2 +j. Since the first element is i and second element is j, doing (i + j) </em> (i + j + 1) gives an even number which is then divided by 2 (floor division). Then the second element is added.</p>
<p>This function also recursively calls itself as shown in the last return statement. So it first divides the list into two parts so for example if the list had 5 elements, the first part would be the first 3 elements and the second part would be the last 2 elements (for list length of 4 it would be 2 and 2 for the splits). It then calls itself (nk2n) with each split or half and repeats the process until the base case of length equals 1 or 2 and finally the ciphertext is outputted.</p>
<p>Here is an example of how it works with the test input flag of &quot;zh3r0{}&quot; :</p>
<pre><code class="lang-python">
flag = [<span class="hljs-number">122</span>, <span class="hljs-number">104</span>, <span class="hljs-number">51</span>, <span class="hljs-number">114</span>, <span class="hljs-number">48</span>, <span class="hljs-number">123</span>, <span class="hljs-number">125</span>]
<span class="hljs-meta">#z   h   <span class="hljs-number">3</span>  r   <span class="hljs-number">0</span>  {   }    </span>
<span class="hljs-meta">#<span class="hljs-number">122</span> <span class="hljs-number">104</span> <span class="hljs-number">51</span> <span class="hljs-number">114</span> <span class="hljs-number">48</span> <span class="hljs-number">123</span> <span class="hljs-number">125</span></span>

def nk2n(nk):

    l = len(nk)
    <span class="hljs-keyword">if</span> l==<span class="hljs-number">1</span>:
        <span class="hljs-keyword">print</span>(<span class="hljs-string">"l == 1 : "</span>, <span class="hljs-string">"returning:"</span>, nk)
        <span class="hljs-keyword">return</span> nk[<span class="hljs-number">0</span>]
    elif l==<span class="hljs-number">2</span>:
        <span class="hljs-meta">#print(<span class="hljs-meta-string">"l ==2:"</span>, nk)</span>
        i,j = nk
        <span class="hljs-keyword">print</span>(<span class="hljs-string">"l == 2 :"</span>, nk, <span class="hljs-string">"returning:"</span>, ( (i+j) * (i+j+<span class="hljs-number">1</span>) ) <span class="hljs-comment">// 2 + j)</span>
        <span class="hljs-keyword">return</span> ( (i+j) * (i+j+<span class="hljs-number">1</span>) ) <span class="hljs-comment">// 2 + j</span>

    <span class="hljs-meta">#print(<span class="hljs-meta-string">"nk2n[:"</span>, l-l<span class="hljs-comment">//2, "] nk2n[", l-l//2, ":]")</span></span>
    <span class="hljs-keyword">print</span>(<span class="hljs-string">"First half : "</span>, nk[:l-l<span class="hljs-comment">//2], "Second half :", nk[ l-l//2:])</span>
    <span class="hljs-keyword">return</span> nk2n(  [ nk2n(nk [:l-l<span class="hljs-comment">//2] ) , nk2n(nk[ l-l//2:] ) ]       )</span>

<span class="hljs-keyword">print</span>(<span class="hljs-string">"The encrypted flag is : "</span>, nk2n(flag))
</code></pre>
<p>And when you test this, you can see how the function keeps splitting the input into half into two halves until the base case of list length 1 or 2 is reached :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img3.png" alt="Zh3r0 2021 Writeup"></p>
<p>So what we have to do is first split the original input into the two previous halves and for each of those halves split them into further two halves until we reach a list of ASCII printable characters (so from ints 32 to 126).</p>
<p>Suppose we start with the input (n) and we need to split it into the two previous halves i and j :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img4.png" alt="Zh3r0 2021 Writeup"></p>
<p>I noticed than when multiplying the equation by 2, (i + j) equals the square root of 2n. So we can now find j :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img9.png" alt="Zh3r0 2021 Writeup"></p>
<p>After dividing the above by 2, we get j. So with that we can get i, it is just the square root of n minus j (as the root of n is i + j). And with that we have split the input into its two previous splits or halves. With that, we could create a function which takes in an input and splits it into the two previous halves. We could repeat this process until we split our original input into a list of only ASCII printable characters (so if we had a certain element lying in the range 32 to 126, we wouldn&#39;t split it further). </p>
<p>One problem that I came across is that sometimes I would get a negative value for j (which probably came because there are two solutions for j (negative and positive) and the negative one happened to be solved for). So my teammate noticed that in these cases where j was negative, the value of i was one less than the absolute value of j. So we solved for i by multiplying j by -1 (as j was negative) and then subtracting 1. With that we have i and we could then calculate j as j equals the equation below (and we know i and n) :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img6.png" alt="Zh3r0 2021 Writeup"></p>
<p>To obtain j, we formed a quadratic equation in terms of j from <code>(i + j) (i + j + 1) + 2j = 2n</code> as shown above (note that we only solved for the positive solution using the quadratic formula as j has to be positive). And with that we now know how to keep splitting each input further and further until we get a list of ASCII characters which is the flag.</p>
<p>This was my solution script :</p>
<pre><code class="lang-python">
import math
from itertools import chain

def nk2n(nk):
    <span class="hljs-keyword">l</span> = len(nk)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">l</span>==1:
        <span class="hljs-keyword">return</span> nk[0]
    elif <span class="hljs-keyword">l</span>==2:
        i,j = nk
        <span class="hljs-keyword">return</span> ((i+j)*(i+j+1))<span class="hljs-comment">//2 +j</span>
    <span class="hljs-keyword">return</span> nk2n([nk2n(nk[:<span class="hljs-keyword">l</span>-<span class="hljs-keyword">l</span><span class="hljs-comment">//2]), nk2n(nk[l-l//2:])])</span>

_1_50 = 1 &lt;&lt; 50  # 2**50 == 1,125,899,906,842,624

def isqrt(x):
    <span class="hljs-keyword">if</span> x &lt; 0:
        raise ValueError('square root not defined <span class="hljs-keyword">for</span> negative numbers')
    <span class="hljs-keyword">if</span> x &lt; _1_50:
        <span class="hljs-keyword">return</span> int(math.<span class="hljs-built_in">sqrt</span>(x))  # <span class="hljs-keyword">use</span> math's <span class="hljs-built_in">sqrt</span>() <span class="hljs-keyword">for</span> small parameters
    <span class="hljs-keyword">n</span> = int(x)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">n</span> &lt;= 1:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">n</span>  # handle <span class="hljs-built_in">sqrt</span>(0)==0, <span class="hljs-built_in">sqrt</span>(1)==1
    r = 1 &lt;&lt; ((<span class="hljs-keyword">n</span>.bit_length() + 1) &gt;&gt; 1)
    <span class="hljs-keyword">while</span> True:
        newr = (r + <span class="hljs-keyword">n</span> <span class="hljs-comment">// r) &gt;&gt; 1  # next estimate by Newton-Raphson</span>
        <span class="hljs-keyword">if</span> newr &gt;= r:
            <span class="hljs-keyword">return</span> r     
        r = newr

def quadraticFormulaPositive(a, b, c):
    t1 = (-1) * b
    discriminant = (pow(b, 2)) - (4) * a * c
    t4 = math.<span class="hljs-built_in">sqrt</span>(discriminant)
    <span class="hljs-keyword">return</span> int( (t1) + t4 ) <span class="hljs-comment">// ( 2 * a)</span>

def nextPrevious2(<span class="hljs-keyword">n</span>):
    n2 = 2 * <span class="hljs-keyword">n</span>
    pPlusq = isqrt(n2)
    j2 = n2 - (pPlusq)*(pPlusq+1)
    <span class="hljs-keyword">if</span> (j2 &lt; 0):
        i = ( (-1) * j2<span class="hljs-comment">//2 ) - 1</span>
        c = pow(i, 2) + i -n2
        j = quadraticFormulaPositive(1, (3 + 2*i), c)
        <span class="hljs-keyword">return</span> [i, j]
    j = j2<span class="hljs-comment">//2</span>
    i = pPlusq - <span class="hljs-built_in">j</span>
    check = ( (i + j) * (i + j + 1) ) <span class="hljs-comment">// 2 + j</span>
    #<span class="hljs-keyword">print</span>(check - <span class="hljs-keyword">n</span>)
    <span class="hljs-keyword">return</span> [i, j]

<span class="hljs-keyword">input</span> = 2597749519984520018193538914972744028780767067373210633843441892910830749749277631182596420937027368405416666234869030284255514216592219508067528406889067888675964979055810441575553504341722797908073355991646423732420612775191216409926513346494355434293682149298585 
masterList = nextPrevious2(<span class="hljs-keyword">input</span>)
<span class="hljs-keyword">print</span>(<span class="hljs-string">"Initial 2 splits : "</span>, masterList)

<span class="hljs-keyword">while</span> (nk2n(masterList) == <span class="hljs-keyword">input</span>):
    previousMasterList = masterList
    tempList = []
    allless = True
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">range</span>(len(masterList)):
        #<span class="hljs-keyword">print</span>(<span class="hljs-string">"element i:"</span>, masterList[i])
        <span class="hljs-keyword">if</span> masterList[i] &gt; 126:
            tempList.<span class="hljs-keyword">append</span>(nextPrevious2(masterList[i]))
            allless = False
        <span class="hljs-keyword">else</span>:
            tempList.<span class="hljs-keyword">append</span>([masterList[i],])
        #<span class="hljs-keyword">print</span>(<span class="hljs-string">"TL:"</span>, tempList)
    masterList = <span class="hljs-keyword">list</span>(chain.from_iterable(tempList))
    <span class="hljs-keyword">if</span> allless:
        <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">print</span>(<span class="hljs-string">"ML:"</span>, masterList)

<span class="hljs-keyword">print</span>(<span class="hljs-string">"Flag ASCII List Is : "</span>, previousMasterList)


flag = <span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">range</span>(len(previousMasterList)):
    flag = flag + chr(previousMasterList[i])

<span class="hljs-keyword">print</span>(flag)
</code></pre>
<p>And after running the script (you can see how the original input is split into its halves and so on until you reach the flag - list of ASCII characters) :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img8.png" alt="Zh3r0 2021 Writeup"></p>
<p><strong>Flag :</strong> zh3r0{wh0_th0ugh7_b1j3c710n5_fr0m_n^k_t0_n_c0uld_b3_s00000_c0000000l!}</p>
<p><br/></p>
<h1 id="chaos-cryptography-">chaos (Cryptography)</h1>
<p><img src="/assets/img/ctfImages/zh3r02021/img10.png" alt="Zh3r0 2021 Writeup"></p>
<p>This was the source code provided for the challenge :</p>
<pre><code class="lang-python">
from secret <span class="hljs-keyword">import</span> flag
def ROTL(value, bits, size=<span class="hljs-number">32</span>):
    <span class="hljs-keyword">return</span> ((value % (<span class="hljs-number">1</span> &lt;&lt; (size - bits))) &lt;&lt; bits) | (value &gt;&gt; (size - bits))

def ROTR(value, bits, size=<span class="hljs-number">32</span>):
    <span class="hljs-keyword">return</span> ((value % (<span class="hljs-number">1</span> &lt;&lt; bits)) &lt;&lt; (size - bits)) | (value &gt;&gt; bits)

def pad(pt):
    pt+=b<span class="hljs-string">'\x80'</span>
    L = <span class="hljs-built_in">len</span>(pt)
    to_pad = <span class="hljs-number">60</span>-(L%<span class="hljs-number">64</span>) <span class="hljs-keyword">if</span> L%<span class="hljs-number">64</span> &lt;= <span class="hljs-number">60</span> <span class="hljs-keyword">else</span> <span class="hljs-number">124</span>-(L%<span class="hljs-number">64</span>)
    padding = bytearray(to_pad) + <span class="hljs-keyword">int</span>.to_bytes(L<span class="hljs-number">-1</span>,<span class="hljs-number">4</span>,<span class="hljs-string">'big'</span>)
    <span class="hljs-keyword">return</span> pt+padding

def hash(text:bytes):
    text = pad(text)
    text = [<span class="hljs-keyword">int</span>.from_bytes(text[i:i+<span class="hljs-number">4</span>],<span class="hljs-string">'big'</span>) <span class="hljs-keyword">for</span> i in <span class="hljs-keyword">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text),<span class="hljs-number">4</span>)]
    M = <span class="hljs-number">0xffff</span>
    x,y,z,u = <span class="hljs-number">0x0124fd</span>ce, <span class="hljs-number">0x89ab57ea</span>, <span class="hljs-number">0xba89370a</span>, <span class="hljs-number">0xfedc45ef</span>
    A,B,C,D = <span class="hljs-number">0x401ab257</span>, <span class="hljs-number">0xb7cd</span>34e1, <span class="hljs-number">0x76b3a27c</span>, <span class="hljs-number">0xf13c3adf</span>
    RV1,RV2,RV3,RV4 = <span class="hljs-number">0xe12f23cd</span>, <span class="hljs-number">0xc5ab6789</span>, <span class="hljs-number">0xf1234567</span>, <span class="hljs-number">0x9a8bc7ef</span>
    <span class="hljs-keyword">for</span> i in <span class="hljs-keyword">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text),<span class="hljs-number">4</span>):
        X,Y,Z,U = text[i]^x,text[i+<span class="hljs-number">1</span>]^y,text[i+<span class="hljs-number">2</span>]^z,text[i+<span class="hljs-number">3</span>]^u
        RV1 ^= (x := (X&amp;<span class="hljs-number">0xffff</span>)*(M - (Y&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(Z,<span class="hljs-number">1</span>) ^ ROTR(U,<span class="hljs-number">1</span>) ^ A)
        RV2 ^= (y := (Y&amp;<span class="hljs-number">0xffff</span>)*(M - (Z&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(U,<span class="hljs-number">2</span>) ^ ROTR(X,<span class="hljs-number">2</span>) ^ B)
        RV3 ^= (z := (Z&amp;<span class="hljs-number">0xffff</span>)*(M - (U&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(X,<span class="hljs-number">3</span>) ^ ROTR(Y,<span class="hljs-number">3</span>) ^ C)
        RV4 ^= (u := (U&amp;<span class="hljs-number">0xffff</span>)*(M - (X&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(Y,<span class="hljs-number">4</span>) ^ ROTR(Z,<span class="hljs-number">4</span>) ^ D)
    <span class="hljs-keyword">for</span> i in <span class="hljs-keyword">range</span>(<span class="hljs-number">4</span>):
        RV1 ^= (x := (X&amp;<span class="hljs-number">0xffff</span>)*(M - (Y&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(Z,<span class="hljs-number">1</span>) ^ ROTR(U,<span class="hljs-number">1</span>) ^ A)
        RV2 ^= (y := (Y&amp;<span class="hljs-number">0xffff</span>)*(M - (Z&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(U,<span class="hljs-number">2</span>) ^ ROTR(X,<span class="hljs-number">2</span>) ^ B)
        RV3 ^= (z := (Z&amp;<span class="hljs-number">0xffff</span>)*(M - (U&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(X,<span class="hljs-number">3</span>) ^ ROTR(Y,<span class="hljs-number">3</span>) ^ C)
        RV4 ^= (u := (U&amp;<span class="hljs-number">0xffff</span>)*(M - (X&gt;&gt;<span class="hljs-number">16</span>)) ^ ROTL(Y,<span class="hljs-number">4</span>) ^ ROTR(Z,<span class="hljs-number">4</span>) ^ D)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">int</span>.to_bytes( (RV1&lt;&lt;<span class="hljs-number">96</span>)|(RV2&lt;&lt;<span class="hljs-number">64</span>)|(RV3&lt;&lt;<span class="hljs-number">32</span>)|RV4 ,<span class="hljs-number">16</span>,<span class="hljs-string">'big'</span>)

try:
    m1 = bytes.fromhex(input(<span class="hljs-string">"input first string to hash : "</span>))
    m2 = bytes.fromhex(input(<span class="hljs-string">"input second string to hash : "</span>))
    <span class="hljs-keyword">if</span> m1!=m2 and hash(m1)==hash(m2):
        <span class="hljs-built_in">print</span>(flag)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'Never gonna give you up'</span>)
except:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'Never gonna let you down'</span>)
</code></pre>
<p>So as shown above, we have to input two different hex values but when their hash is calculated using the <code>hash</code> function shown above, their hashes have to be equal. This is a case of <a href="https://eprint.iacr.org/2005/403.pdf" target="_blank">collisions in a chaotic hash function</a>.</p>
<p>As stated in the above link, &quot;Finally, observe that making (X,Y,Z,U) all 0xffffffff or all 0 results in the same output of the chaos function&quot;. So if your first input (m1) corresponds to 0xffffffff, we need to reverse the second input (m2) to correspond to 0x00000000. This would be achieved by flipping the bits of the first input (a complementing collision). </p>
<p>So if my first input is &quot;0124fdce89ab57eaba89370afedc45ef401ab257b7cd34e176b3a27cf13c3adf&quot;, I need the flip each nibble (hex = 2 nibbles = 1 byte) and that will be my second input which would produce the same hash.</p>
<p>So I made a tiny script that does just that :</p>
<pre><code class="lang-python">
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> * 

m1 = <span class="hljs-string">"0124fdce89ab57eaba89370afedc45ef401ab257b7cd34e176b3a27cf13c3adf"</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">flipBits</span><span class="hljs-params">(input)</span>:</span>
    m2 = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (len(m1)):
        m2 = m2 + <span class="hljs-string">'{:x}'</span>.format(~int(m1[i], <span class="hljs-number">16</span>) + <span class="hljs-number">16</span>) 
    <span class="hljs-keyword">return</span> m2

m2 = flipBits(m1)

r = remote(<span class="hljs-string">'crypto.zh3r0.cf'</span>, <span class="hljs-number">2222</span>)
r.sendlineafter(<span class="hljs-string">"input first string to hash : "</span>, m1)
r.sendlineafter(<span class="hljs-string">"input second string to hash : "</span>, m2)

flag = r.recvline()
print(flag)
</code></pre>
<p>And after running it, you get the flag :</p>
<p><img src="/assets/img/ctfImages/zh3r02021/img12.png" alt="Zh3r0 2021 Writeup"></p>
<p><strong>Flag :</strong> zh3r0{something_chaotic_may_look_random_enough_but_may_be_not_sufficiently_secure}</p>

<div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">flag&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[<span style="color:#c10aff">122</span>,&nbsp;<span style="color:#c10aff">104</span>,&nbsp;<span style="color:#c10aff">51</span>,&nbsp;<span style="color:#c10aff">114</span>,&nbsp;<span style="color:#c10aff">48</span>,&nbsp;<span style="color:#c10aff">123</span>,&nbsp;<span style="color:#c10aff">125</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#z&nbsp;&nbsp;&nbsp;h&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#122&nbsp;104&nbsp;51&nbsp;114&nbsp;48&nbsp;123&nbsp;125</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">def</span>&nbsp;nk2n(nk):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">len</span>(nk)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;l<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"l&nbsp;==&nbsp;1&nbsp;:&nbsp;"</span>,&nbsp;<span style="color:#ffd500">"returning:"</span>,&nbsp;nk)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;nk[<span style="color:#c10aff">0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">elif</span>&nbsp;l<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">2</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#print("l&nbsp;==2:",&nbsp;nk)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,j&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;nk</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"l&nbsp;==&nbsp;2&nbsp;:"</span>,&nbsp;nk,&nbsp;<span style="color:#ffd500">"returning:"</span>,&nbsp;(&nbsp;(i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>j)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;(i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>j<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>)&nbsp;)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;<span style="color:#c10aff">2</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;j)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;(&nbsp;(i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>j)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;(i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>j<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>)&nbsp;)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;<span style="color:#c10aff">2</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;j</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#print("nk2n[:",&nbsp;l-l//2,&nbsp;"]&nbsp;nk2n[",&nbsp;l-l//2,&nbsp;":]")</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"First&nbsp;half&nbsp;:&nbsp;"</span>,&nbsp;nk[:l<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>l<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#c10aff">2</span>],&nbsp;<span style="color:#ffd500">"Second&nbsp;half&nbsp;:"</span>,&nbsp;nk[&nbsp;l<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>l<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#c10aff">2</span>:])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;nk2n(&nbsp;&nbsp;[&nbsp;nk2n(nk&nbsp;[:l<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>l<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#c10aff">2</span>]&nbsp;)&nbsp;,&nbsp;nk2n(nk[&nbsp;l<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>l<span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#0086b3"></span><span style="color:#ff3399">/</span><span style="color:#c10aff">2</span>:]&nbsp;)&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"The&nbsp;encrypted&nbsp;flag&nbsp;is&nbsp;:&nbsp;"</span>,&nbsp;nk2n(flag))</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
